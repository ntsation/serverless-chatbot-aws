scalar AWSDateTime

type User {
  id: ID!
  name: String!
  email: String!
  createdAt: AWSDateTime!
}

type Chat {
  id: ID!
  userId: ID!
  title: String!
  createdAt: AWSDateTime!
}

type Message {
  id: ID! @aws_iam @aws_api_key @aws_cognito_user_pools
  chatId: ID! @aws_iam @aws_api_key @aws_cognito_user_pools
  userId: ID! @aws_iam @aws_api_key @aws_cognito_user_pools
  role: String! @aws_iam @aws_api_key @aws_cognito_user_pools
  content: String! @aws_iam @aws_api_key @aws_cognito_user_pools
  createdAt: AWSDateTime! @aws_iam @aws_api_key @aws_cognito_user_pools
}

type MessageConnection {
  items: [Message!]! @aws_iam @aws_api_key @aws_cognito_user_pools
  nextToken: String
}

type Query {
  me: User!
  getChat(id: ID!): Chat!
  listChatsByUser(userId: ID!, limit: Int, nextToken: String): [Chat!]!
  listMessages(chatId: ID!, limit: Int, nextToken: String): MessageConnection! @aws_iam @aws_api_key @aws_cognito_user_pools
}

type Mutation {
  createUser(email: String!): User
  createChat(title: String!, userId: ID!): Chat
  sendMessage(chatId: ID!, content: String!): Message
  addAssistantMessage(chatId: ID!, content: String!, userId: ID!): Message @aws_iam @aws_api_key @aws_cognito_user_pools
  deleteChat(id: ID!): Boolean
}

type Subscription {
  onMessageSent(chatId: ID!): Message
    @aws_subscribe(mutations: ["sendMessage", "addAssistantMessage"])
}